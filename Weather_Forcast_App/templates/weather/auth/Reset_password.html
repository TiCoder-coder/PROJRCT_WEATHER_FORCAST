{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u - VN Weather Hub</title>
    <link rel="stylesheet" href="{% static 'weather/css/Auth.css' %}?v=9910021">
</head>
<body class="auth-page">
    <div class="auth-bg">
        <div class="auth-particles"></div>
        <div class="auth-gradient"></div>
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
    </div>

    <div class="auth-container">
        <div class="auth-card glass-effect">
            <div class="auth-header">
                <div class="auth-logo-wrapper">
                    <div class="auth-logo">
                        <span class="logo-dot pulse-dot"></span>
                        <span class="logo-text">VN Weather Hub</span>
                    </div>
                </div>
                <div class="icon-wrapper">
                    <div class="icon-circle">
                        <span class="icon-emoji">üîë</span>
                    </div>
                </div>
                <h1 class="auth-title gradient-text">ƒê·∫∑t m·∫≠t kh·∫©u m·ªõi</h1>
                <p class="auth-subtitle">Nh·∫≠p m·∫≠t kh·∫©u m·ªõi cho t√†i kho·∫£n c·ªßa b·∫°n</p>
            </div>

            {% if messages %}
                <div class="auth-messages">
                    {% for message in messages %}
                        <div class="auth-alert auth-alert-{{ message.tags }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            {% if validlink %}
                <form method="post" class="auth-form" novalidate>
                    {% csrf_token %}
                    
                    <div class="form-group animated-input">
                        <label for="new_password1" class="form-label">
                            <span class="label-icon">üîê</span>
                            M·∫≠t kh·∫©u m·ªõi
                        </label>
                        <div class="password-wrapper">
                            <input 
                                type="password" 
                                id="new_password1" 
                                name="new_password1" 
                                class="form-input"
                                placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi"
                                required
                                minlength="8"
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('new_password1')">
                                üëÅÔ∏è
                            </button>
                            <span class="input-border"></span>
                        </div>
                        <span class="form-hint">
                            <span class="hint-icon">üí°</span>
                            T·ªëi thi·ªÉu 8 k√Ω t·ª±, bao g·ªìm ch·ªØ v√† s·ªë
                        </span>
                    </div>

                    <div class="form-group animated-input">
                        <label for="new_password2" class="form-label">
                            <span class="label-icon">üîí</span>
                            X√°c nh·∫≠n m·∫≠t kh·∫©u
                        </label>
                        <div class="password-wrapper">
                            <input 
                                type="password" 
                                id="new_password2" 
                                name="new_password2" 
                                class="form-input"
                                placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi"
                                required
                            >
                            <button type="button" class="password-toggle" onclick="togglePassword('new_password2')">
                                üëÅÔ∏è
                            </button>
                            <span class="input-border"></span>
                        </div>
                    </div>

                    <div class="password-requirements gradient-border">
                        <h4 class="requirements-title">‚úì Y√™u c·∫ßu m·∫≠t kh·∫©u:</h4>
                        <ul class="requirements-list">
                            <li id="length" class="requirement-item">‚úì T·ªëi thi·ªÉu 8 k√Ω t·ª±</li>
                            <li id="number" class="requirement-item">‚úì Ch·ª©a √≠t nh·∫•t 1 s·ªë</li>
                            <li id="letter" class="requirement-item">‚úì Ch·ª©a ch·ªØ c√°i</li>
                        </ul>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full btn-glow">
                        <span class="btn-ripple"></span>
                        <span class="btn-text">ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u</span>
                        <span class="btn-icon">‚úì</span>
                    </button>
                </form>
            {% else %}
                <div class="auth-error-box animated-shake">
                    <div class="error-icon-wrapper">
                        <div class="error-icon pulse">‚ö†Ô∏è</div>
                    </div>
                    <h3 class="error-title">Li√™n k·∫øt kh√¥ng h·ª£p l·ªá ho·∫∑c ƒë√£ h·∫øt h·∫°n</h3>
                    <p class="error-message">Li√™n k·∫øt ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u n√†y kh√¥ng c√≤n h·ª£p l·ªá. Vui l√≤ng y√™u c·∫ßu m·ªôt li√™n k·∫øt m·ªõi.</p>
                    <a href="{% url 'weather:forgot_password' %}" class="btn btn-primary btn-glow">
                        <span class="btn-ripple"></span>
                        <span class="btn-text">Y√™u c·∫ßu li√™n k·∫øt m·ªõi</span>
                    </a>
                </div>
            {% endif %}

            <div class="auth-footer">
                <div class="auth-links">
                    <a href="{% url 'weather:login' %}" class="auth-link">
                        ‚Üê Quay l·∫°i ƒëƒÉng nh·∫≠p
                    </a>
                </div>
            </div>
        </div>

        <div class="auth-extra">
            <a href="{% url 'weather:home' %}" class="back-home">
                üè† V·ªÅ trang ch·ªß
            </a>
        </div>
    </div>

    <div class="wx-layer wx-clouds" aria-hidden="true"></div>
    <div class="wx-layer wx-rain" aria-hidden="true"></div>

    <script>
        function togglePassword(inputId) {
            const input = document.getElementById(inputId);
            const button = input.nextElementSibling;
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = 'üôà';
            } else {
                input.type = 'password';
                button.textContent = 'üëÅÔ∏è';
            }
        }

        const password1 = document.getElementById('new_password1');
        if (password1) {
            password1.addEventListener('input', function() {
                const value = this.value;
                const lengthCheck = document.getElementById('length');
                const numberCheck = document.getElementById('number');
                const letterCheck = document.getElementById('letter');

                if (lengthCheck) {
                    lengthCheck.style.color = value.length >= 8 ? '#48bb78' : '#cbd5e0';
                }
                if (numberCheck) {
                    numberCheck.style.color = /\d/.test(value) ? '#48bb78' : '#cbd5e0';
                }
                if (letterCheck) {
                    letterCheck.style.color = /[a-zA-Z]/.test(value) ? '#48bb78' : '#cbd5e0';
                }
            });
        }
    </script>
</body>
</html>
