{% load static %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Weather Forecast Dashboard</title>
    <link rel="stylesheet" href="{% static 'weather/css/Home.css' %}?v=4110000">

</head>
<body class="home-page">


    <!-- TOP NAV -->
    <header class="home-header">
        <div class="logo">
            <span class="logo-dot"></span>
            <span class="logo-text">VN Weather Hub</span>
        </div>
        <nav class="home-nav">
            <button type="button" class="nav-pill" id="btnIntro">Introduce</button>
        </nav>
    </header>

    <!-- HERO -->
     
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="wind-layer" aria-hidden="true">
            <span class="wind w1"></span>
            <span class="wind w2"></span>
            <span class="wind w3"></span>
            <span class="wind w4"></span>
            <span class="wind w5"></span>
        </div>
        <div class="hero-anim" aria-hidden="true">
            <!-- SUN -->
            <div class="wx wx-sun">
                <svg class="wx-svg" viewBox="0 0 120 120">
                <g class="sun-rays">
                    <line x1="60" y1="8"  x2="60" y2="22"></line>
                    <line x1="60" y1="98" x2="60" y2="112"></line>
                    <line x1="8"  y1="60" x2="22" y2="60"></line>
                    <line x1="98" y1="60" x2="112" y2="60"></line>
                    <line x1="18" y1="18" x2="28" y2="28"></line>
                    <line x1="92" y1="92" x2="102" y2="102"></line>
                    <line x1="18" y1="102" x2="28" y2="92"></line>
                    <line x1="92" y1="28" x2="102" y2="18"></line>
                </g>
                <circle class="sun-core" cx="60" cy="60" r="22"></circle>
                </svg>
            </div>

            <!-- CLOUD -->
            <div class="wx wx-cloud">
                <svg class="wx-svg" viewBox="0 0 220 140">
                <path class="cloud-fill"
                    d="M78 106h92c18 0 32-12 32-28s-14-28-32-28c-2 0-4 0-6 .3C156 30 139 16 118 16
                    92 16 71 35 71 60c0 1.3.1 2.6.2 3.8C52 66 38 80 38 97c0 16 13 29 40 29z"/>
                <path class="cloud-stroke"
                    d="M78 106h92c18 0 32-12 32-28s-14-28-32-28c-2 0-4 0-6 .3C156 30 139 16 118 16
                    92 16 71 35 71 60c0 1.3.1 2.6.2 3.8C52 66 38 80 38 97c0 16 13 29 40 29z"/>
                </svg>
            </div>

            <!-- RAIN -->
            <div class="wx wx-rain">
                <svg class="wx-svg" viewBox="0 0 240 170">
                <path class="cloud-fill"
                    d="M86 112h102c20 0 36-13 36-31s-16-31-36-31c-2 0-4 0-7 .4C175 27 156 12 132 12
                    102 12 78 34 78 61c0 1.5.1 3 .3 4.4C56 68 40 84 40 103c0 18 15 33 46 33z"/>
                <path class="cloud-stroke"
                    d="M86 112h102c20 0 36-13 36-31s-16-31-36-31c-2 0-4 0-7 .4C175 27 156 12 132 12
                    102 12 78 34 78 61c0 1.5.1 3 .3 4.4C56 68 40 84 40 103c0 18 15 33 46 33z"/>

                <g class="rain-lines">
                    <line x1="88"  y1="124" x2="78"  y2="156"></line>
                    <line x1="120" y1="124" x2="110" y2="162"></line>
                    <line x1="152" y1="124" x2="142" y2="156"></line>
                    <line x1="184" y1="124" x2="174" y2="162"></line>
                </g>
                </svg>
            </div>

            <!-- EARTH (rotating) -->
            <div class="earth-wrap">
                <div class="earth"></div>
                <div class="earth-orbit"></div>
            </div>

            </div>

        <!-- WEATHER ICONS (animated) -->
        <div class="hero-weather" aria-hidden="true">
            <!-- SUN -->
            <div class="wx wx-sun">
            <svg class="wx-svg" viewBox="0 0 120 120">
                <g class="sun-rays">
                <line x1="60" y1="6"  x2="60" y2="20"></line>
                <line x1="60" y1="100" x2="60" y2="114"></line>
                <line x1="6"  y1="60" x2="20" y2="60"></line>
                <line x1="100" y1="60" x2="114" y2="60"></line>

                <line x1="18" y1="18" x2="28" y2="28"></line>
                <line x1="92" y1="92" x2="102" y2="102"></line>
                <line x1="18" y1="102" x2="28" y2="92"></line>
                <line x1="92" y1="28" x2="102" y2="18"></line>

                <line x1="34" y1="10" x2="40" y2="24"></line>
                <line x1="86" y1="96" x2="80" y2="110"></line>
                <line x1="10" y1="86" x2="24" y2="80"></line>
                <line x1="96" y1="34" x2="110" y2="40"></line>
                </g>
                <circle class="sun-core" cx="60" cy="60" r="18"></circle>
            </svg>
            </div>

            <!-- CLOUD -->
            <div class="wx wx-cloud">
            <svg class="wx-svg" viewBox="0 0 220 140">
                <path class="cloud-shape"
                    d="M78 104h92c18 0 32-12 32-28 0-15-12-27-28-28
                        -4-20-22-35-44-35-18 0-33 9-40 22
                        -3-1-7-2-11-2-18 0-33 14-33 31
                        0 3 0 6 1 9C32 78 20 89 20 104c0 16 14 28 31 28h27z"/>
            </svg>
            </div>

            <!-- RAIN -->
            <div class="wx wx-rain">
            <svg class="wx-svg" viewBox="0 0 220 180">
                <path class="cloud-shape"
                    d="M78 86h92c18 0 32-12 32-28 0-15-12-27-28-28
                        -4-20-22-35-44-35-18 0-33 9-40 22
                        -3-1-7-2-11-2-18 0-33 14-33 31
                        0 3 0 6 1 9C32 60 20 71 20 86c0 16 14 28 31 28h27z"/>
                <g class="rain-drops">
                <line x1="70"  y1="120" x2="60"  y2="150"></line>
                <line x1="105" y1="120" x2="95"  y2="155"></line>
                <line x1="140" y1="120" x2="130" y2="150"></line>
                <line x1="175" y1="120" x2="165" y2="155"></line>
                </g>
            </svg>
            </div>
        </div>

        <div class="hero-content">
            <h1>Realtime Vietnam Weather Data</h1>
            <p>
                Thu th·∫≠p ‚Äì h·ª£p nh·∫•t ‚Äì tr·ª±c quan h√≥a d·ªØ li·ªáu th·ªùi ti·∫øt t·ª´ API-HTML c·ªßa Vrain v√† 
                OpenWeather trong m·ªôt Dashboard duy nh·∫•t.
            </p>
            <div class="hero-actions">
                <button type="button" class="btn primary" id="btnOpenCrawlModal">
                    B·∫Øt ƒë·∫ßu crawl Vrain
                </button>
                <a class="btn secondary" href="{% url 'weather:datasets' %}">
                    B·ªô dataset g·∫ßn ƒë√¢y
                </a>
                <button type="button" class="btn secondary btn-help" id="btnOpenHelpModal">
                    H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng
                </button>

            </div>

            <div class="hero-meta">
                <div class="meta-item">
                    <span class="meta-label">Th·ªùi gian c·∫≠p nh·∫≠t g·∫ßn nh·∫•t</span>
                    <span class="meta-value">
                        {{ latest_dataset_time|default:"‚Äî" }}
                    </span>
                </div>
            </div>
        </div>

    </section>

    <!-- OVERVIEW SECTION -->
    <section id="overview" class="section overview">
        <h2>T·ªïng quan pipelines</h2>
        <p class="section-desc">
            M·ªói pipeline t∆∞∆°ng ·ª©ng v·ªõi m·ªôt ngu·ªìn d·ªØ li·ªáu: API qu·ªëc t·∫ø, HTML c·ªßa Vrain, OpenWeather.
        </p>

        <div class="cards">
            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/api.svg' %}"
                         alt="API icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>API OpenWeather</h3>
                <p>
                    G·ªçi API ƒë·ªÉ l·∫•y d·ªØ li·ªáu nhi·ªát ƒë·ªô, ƒë·ªô ·∫©m, gi√≥, m√¢y‚Ä¶
                    cho to√†n b·ªô Vi·ªát Nam theo th·ªùi gian th·ª±c.
                </p>
            </div>

            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/vrain.svg' %}"
                         alt="Vrain icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>Vrain ‚Äì HTML/Selenium</h3>
                <p>
                    Crawl l∆∞·ª£ng m∆∞a t·∫°i t·ª´ng tr·∫°m/Vin t·ª´ website Vrain b·∫±ng Selenium,
                    l∆∞u th√†nh file CSV/Excel ƒë·ªÉ ph√¢n t√≠ch.
                </p>
            </div>

            <div class="card">
                <div class="card-icon">
                    <img src="{% static 'weather/img/icons/report.svg' %}"
                         alt="Report icon"
                         onerror="this.style.display='none'">
                </div>
                <h3>Merge & Dashboard</h3>
                <p>
                    H·ª£p nh·∫•t d·ªØ li·ªáu t·ª´ nhi·ªÅu ngu·ªìn, xu·∫•t Excel, v√† chu·∫©n b·ªã
                    cho b∆∞·ªõc visualize b·∫±ng Power BI / Grafana / Web chart.
                </p>
            </div>
        </div>
    </section>

    <!-- DATASETS SECTION -->
    <section id="datasets" class="section datasets">
        <h2>C√°c l·∫ßn crawl data g·∫ßn ƒë√¢y</h2>

        <div class="dataset-grid">
            <div class="dataset-card">
                <h3>API OpenWeather</h3>
                <p>L∆∞·ª£t ch·∫°y: {{ total_api_runs|default:0 }}</p>
                <span class="badge badge-api">API</span>
            </div>

            <div class="dataset-card">
                <h3>Vrain Crawl</h3>
                <p>L∆∞·ª£t ch·∫°y: {{ total_vrain_runs|default:0 }}</p>
                <span class="badge badge-vrain">VRAIN</span>
            </div>

        </div>
    </section>

        <!-- ========== MODAL CH·ªåN C√ÅCH CRAWL VRAIN ========== -->
    <div id="crawlMethodModal" class="crawl-modal">
        <div class="crawl-modal__overlay" data-close-crawl-modal></div>

        <div class="crawl-modal__content">
            <header class="crawl-modal__header">
                <h2>Ch·ªçn c√°ch crawl d·ªØ li·ªáu Vrain</h2>
                <button type="button"
                        class="crawl-modal__close"
                        data-close-crawl-modal>&times;</button>
            </header>


            <div class="crawl-modal__grid">
                <!-- 1. Crawl_data_by_API.py -->
                <div class="crawl-card">
                    <h3>1. Crawl qua API c·ªßa OpenWeather</h3>
                    <ul class="crawl-card__list">
                        <li>L·∫•y d·ªØ li·ªáu th·ªùi ti·∫øt t·ª´ API qu·ªëc t·∫ø (nhi·ªát ƒë·ªô, ƒë·ªô ·∫©m, gi√≥, m∆∞a‚Ä¶).</li>
                        <li>Ph√π h·ª£p ƒë·ªÉ c√≥ c√°i nh√¨n t·ªïng quan to√†n qu·ªëc.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="api_weather"
                            data-crawl-label="Crawl_data_by_API.py">
                        Ch·ªçn c√°ch n√†y
                    </button>
                </div>

                <!-- 2. Crawl_data_from_Vrain_by_API.py -->
                <div class="crawl-card">
                    <h3>2. Crawl qua API c·ªßa Vrain</h3>
                    <ul class="crawl-card__list">
                        <li>L·∫•y d·ªØ li·ªáu l∆∞·ª£ng m∆∞a tr·ª±c ti·∫øp t·ª´ API (n·∫øu Vrain c√≥ cung c·∫•p).</li>
                        <li>·ªîn ƒë·ªãnh, √≠t ph·ª• thu·ªôc HTML giao di·ªán.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_api"
                            data-crawl-label="Crawl_data_from_Vrain_by_API.py">
                        Ch·ªçn c√°ch n√†y
                    </button>
                </div>

                <!-- 3. Crawl_data_from_Vrain_by_Selenium.py -->
                <div class="crawl-card">
                    <h3>3. Crawl Vrain b·∫±ng Selenium (multi-ID)</h3>
                    <ul class="crawl-card__list">
                        <li>D√πng Selenium ƒëi·ªÅu khi·ªÉn tr√¨nh duy·ªát, ƒë·ªçc UI Vrain.</li>
                        <li>Ph√π h·ª£p khi c·∫ßn crawl nhi·ªÅu t·ªânh/tr·∫°m c√πng l√∫c.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_selenium"
                            data-crawl-label="Crawl_data_from_Vrain_by_Selenium.py">
                        Ch·ªçn c√°ch n√†y
                    </button>
                </div>

                <!-- 4. Crawl_data_from_html_of_Vrain.py -->
                <div class="crawl-card">
                    <h3>4. Crawl HTML Vrain (ph√¢n t√≠ch source)</h3>
                    <ul class="crawl-card__list">
                        <li>ƒê·ªçc HTML, d√πng regex ƒë·ªÉ tr√≠ch xu·∫•t l∆∞·ª£ng m∆∞a t·ª´ng tr·∫°m.</li>
                        <li>Ph√π h·ª£p khi c·∫ßn fine-tune logic parse HTML.</li>
                    </ul>
                    <button type="button"
                            class="crawl-card__btn"
                            data-crawl-method="vrain_html"
                            data-crawl-label="Crawl_data_from_html_of_Vrain.py">
                        Ch·ªçn c√°ch n√†y
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- ========== MODAL H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG ========== -->
    <div id="helpModal" class="crawl-modal">
        <div class="crawl-modal__overlay" data-close-help-modal></div>

        <div class="crawl-modal__content">
            <header class="crawl-modal__header">
                <h2>üìò H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng VN Weather Hub</h2>
                <button type="button"
                        class="crawl-modal__close"
                        data-close-help-modal>&times;</button>
            </header>

            <div class="help-grid">
                <div class="help-card">
                    <h3>1) Trang Home (Dashboard)</h3>
                    <ul>
                        <li>B·∫•m <b>B·∫Øt ƒë·∫ßu crawl Vrain</b> ƒë·ªÉ ch·ªçn pipeline crawl.</li>
                        <li>K√©o xu·ªëng <b>T·ªïng quan pipelines</b> ƒë·ªÉ xem m√¥ t·∫£ t·ª´ng pipeline.</li>
                        <li>K√©o xu·ªëng <b>Datasets g·∫ßn ƒë√¢y</b> ƒë·ªÉ xem l∆∞·ª£t ch·∫°y t·ª´ng pipeline.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>2) Crawl OpenWeather b·∫±ng API</h3>
                    <ul>
                        <li>V√†o trang <b>Crawl OpenWeather b·∫±ng API</b>.</li>
                        <li>B·∫•m <b>B·∫Øt ƒë·∫ßu crawl</b> ƒë·ªÉ ch·∫°y script.</li>
                        <li>Log s·∫Ω hi·ªÉn th·ªã realtime (n·∫øu backend ƒëang b·∫≠t log).</li>
                        <li>Sau khi xong, file s·∫Ω xu·∫•t v√†o <code>output/</code>.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>3) Crawl Vrain b·∫±ng API</h3>
                    <ul>
                        <li>V√†o trang <b>Crawl Vrain b·∫±ng API</b>.</li>
                        <li>B·∫•m <b>B·∫Øt ƒë·∫ßu crawl</b> ƒë·ªÉ ch·∫°y v√† theo d√µi log.</li>
                        <li>Sau khi xong, file xu·∫•t trong <code>output/</code>.</li>
                    </ul>
                </div>

                <div class="help-card">
                    <h3>4) Crawl Vrain b·∫±ng Selenium / HTML Parse</h3>
                    <ul>
                        <li><b>Selenium</b>: ph√π h·ª£p khi c·∫ßn crawl theo UI / multi-ID.</li>
                        <li><b>HTML Parse</b>: ph√π h·ª£p khi mu·ªën fine-tune logic parse source HTML.</li>
                        <li>B·∫•m <b>B·∫Øt ƒë·∫ßu crawl</b> v√† xem log realtime.</li>
                    </ul>
                </div>

                <div class="help-card help-card--wide">
                    <h3>5) Datasets</h3>
                    <ul>
                        <li>V√†o trang <b>Datasets</b> ƒë·ªÉ xem c√°c file trong <code>output/</code>.</li>
                        <li>C√≥ th·ªÉ <b>View</b> ho·∫∑c <b>Download</b> t√πy file.</li>
                    </ul>
                </div>
            </div>

            <div class="help-actions">
                <button type="button" class="btn primary" data-close-help-modal>
                    ƒê√£ hi·ªÉu
                </button>
            </div>
        </div>
    </div>


    <footer class="home-footer">
        <span>¬© {{ now|default:"2025" }} Weather Forecast Project ‚Äî Built with Django</span>
    </footer>

<script src="{% static 'weather/js/Home.js' %}?v=75549"></script>

<div id="introModal" class="crawl-modal" aria-hidden="true">
  <div class="crawl-modal__overlay" data-close-intro-modal></div>

  <div class="crawl-modal__content intro-modal__content" role="dialog" aria-modal="true">
    <header class="crawl-modal__header">
      <h2>Gi·ªõi thi·ªáu VN Weather Hub</h2>
      <button type="button" class="crawl-modal__close" data-close-intro-modal>&times;</button>
    </header>

    <p class="crawl-modal__subtitle">
      Dashboard thu th·∫≠p & qu·∫£n l√Ω d·ªØ li·ªáu th·ªùi ti·∫øt t·ª´ nhi·ªÅu ngu·ªìn (API + Vrain) trong m·ªôt n∆°i.
    </p>

    <div class="intro-body">
      <div class="intro-block">
        <h3>üéØ D·ª± √°n n√†y l√†m g√¨?</h3>
        <ul>
          <li>Crawl d·ªØ li·ªáu th·ªùi ti·∫øt theo pipeline b·∫°n ch·ªçn.</li>
          <li>L∆∞u file k·∫øt qu·∫£ v√†o th∆∞ m·ª•c <code>output/</code>.</li>
          <li>Xem & t·∫£i dataset ngay trong m·ª•c <b>Datasets</b>.</li>
        </ul>
      </div>

      <div class="intro-block">
        <h3>üß© C√°c pipeline hi·ªán c√≥</h3>
        <ul>
          <li><b>OpenWeather API</b>: l·∫•y nhi·ªát ƒë·ªô/ƒë·ªô ·∫©m/gi√≥‚Ä¶</li>
          <li><b>Vrain HTML/Selenium</b>: crawl l∆∞·ª£ng m∆∞a t·ª´ Vrain.</li>
          <li><b>Vrain API</b>: l·∫•y l∆∞·ª£ng m∆∞a qua API (n·∫øu c√≥).</li>
        </ul>
      </div>

      <div class="intro-block">
        <h3>üìå C√°ch d√πng nhanh</h3>
        <ol>
          <li>Ch·ªçn pipeline c·∫ßn ch·∫°y.</li>
          <li>B·∫•m <b>B·∫Øt ƒë·∫ßu crawl</b> v√† xem log realtime.</li>
          <li>Qua <b>Datasets</b> ƒë·ªÉ xem/t·∫£i file m·ªõi nh·∫•t.</li>
        </ol>
      </div>

      <div class="intro-block">
        <h3>üí° G·ª£i √Ω</h3>
        <ul>
          <li>N·∫øu log kh√¥ng ra ngay: ki·ªÉm tra script c√≥ in log/flush.</li>
          <li>Ch·∫°y xong nh∆∞ng kh√¥ng th·∫•y file: ki·ªÉm tra ƒë∆∞·ªùng d·∫´n <code>output/</code>.</li>
        </ul>
      </div>
    </div>

    <div class="intro-actions">
      <button type="button" class="btn secondary" data-close-intro-modal>ƒê√≥ng</button>
    </div>
  </div>
</div>

</body>
</html>
